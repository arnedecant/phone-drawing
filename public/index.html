<!DOCTYPE html>
<html lang="nl">
<head>

	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">


	<!-- PAGE-LOAD ///////////////////////////////////////////////////
	Resolve and caching DNS lookups initiates downloads faster
	Browsers do this by default for assets present in the markup
	Enable 'dns-prefetch' when dealing with cross-domain assets
	(eg. API-calls, injected urls, 3rd party libs, ...)

	<link rel="dns-prefetch" href="//google-analytics.com" />
	<link rel="dns-prefetch" href="//fonts.googleapis.com" />
	<link rel="dns-prefetch" href="//fonts.gstatic.com" />
	<link rel="dns-prefetch" href="//cdnjs.cloudflare.com" />
	-->

	<!--
	Use 'preconnect' to keep DNS lookups and handshakes open
	NOTE: limited support, to be used in combination with 'dns-prefetch'

	<link rel="preconnect" href="//cdnjs.cloudflare.com" crossorigin />
	-->

	<!--
	Use 'prefetch' to preload assets once this page has finished
	loading or 'prerender' to preload entire pages (with assets)
	This results in faster downloads of assets and pages when
	needed (eg. load ondemand, navigating to another page, ...)

	<link rel="prefetch" href="{{ SOME-ASSET-OR-ANOTHER-PAGE }}" />
	<link rel="prerender" href="{{ ANOTHER-PAGE }}" />
	-->


	<!-- CSS ///////////////////////////////////////////////////////// -->
	
	<link rel="stylesheet" href="css/index.css">


	<!-- SEO /////////////////////////////////////////////////////////
	Set meta-data and force search engines to display this information
	in search results (this prevents caching of meta-data)
	-->

	<title>Audio visualizer</title>

	<meta name="description" content="">
	<meta name="robots" content="noodp, noydir">

	<!--
	Signal search engines to 'use-this-URL-for-this-page', use this
	when parameters (# or ?) are used to control the display state
	<link rel="canonical" href="http://www.{{ URL }}" />
	-->


	<!-- META-TAGS FOR MOBILE ////////////////////////////////////////
	Set the viewport for IOS to enable media queries and prevent phone
	numbers from being displayed as hyperlinks (IOS default behavior)
	NOTE: don't disable the ability to zoom, it's bad UX
	NOTE: since IOS 11.3 scaling properties are ignored (needs R&D)

	- iOS full screen with viewport-fit=cover
	- https://stackoverflow.com/questions/46476265/ios-full-screen-web-app-color-status-bar

	<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, initial-scale=1.0, user-scalable=no, viewport-fit=cover" />
	<meta name="format-detection" content="telephone=no,date=no,address=no,email=no,url=no"/>
	-->

	<meta name="viewport" content="width=device-width,initial-scale=1">


	<!-- MOBILE STANDALONE MODE //////////////////////////////////////
	Enable the page to run in standalone (chromeless) mode from
	the homescreen on Android and IOS

	<meta name="mobile-web-app-capable" content="yes" />
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="apple-mobile-web-app-title" content="@@seo-title" />
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

	<meta name="application-name" content="@@seo-title">
	<meta name="theme-color" content="#000000">
	<meta name="msapplication-navbutton-color" content="#000000">
	-->


	<!-- G+ AND FACEBOOK /////////////////////////////////////////////

	<meta property="og:type" content="article" />
	<meta property="og:title" content="@@seo-title" />
	<meta property="og:description" content="@@seo-description" />
	<meta property="og:image" content="http://www.{{ URL }}/social.jpg" />
	<meta property="og:url" content="http://www.{{ URL }}" />
	-->


	<!-- TWITTER CARDS ///////////////////////////////////////////////
	NOTE: Twitter cards need to be validated and approved after launch
	====> https://dev.twitter.com/docs/cards/validation/validator

	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:site" content="@{{ TWITTER-ACCOUNT }}" />
	<meta name="twitter:title" content="@@seo-title" />
	<meta name="twitter:description" content="@@seo-description" />
	<meta name="twitter:image:src" content="http://www.{{ URL }}/social.jpg" />
	-->


	<!-- FAVICONS ////////////////////////////////////////////////////
	- http://favicon.htmlkit.com/favicon
	- http://www.favicomatic.com
	-->

	<link rel="apple-touch-icon" href="apple-touch-icon.png">
	<link rel="icon" href="favicon.ico">

</head>
<body>

	<table data-ref="log">
    <thead>
        <th>X</th>
        <th>Y</th>
        <th>Z</th>
    </thead>
    <tbody>
        
    </tbody>
</table>

	<!-- SVG ICONS ///////////////////////////////////////////////////////
- https://codepen.io/ruandre/pen/howFi
- http://www.svgminify.com

Usage example:

<svg width="44" height="44"><use xlink:href="#icon-facebook" /></svg>
<svg width="44" height="44"><use xlink:href="#icon-twitter" /></svg>

License:

Icons provided by FontAwesome. No changes were made to these icons. More info: https://fontawesome.com/license/free

-->

<svg style="display: none;" xmlns="http://www.w3.org/2000/svg">

	<symbol id="icon-minus" aria-hidden="true" focusable="false" role="img" viewBox="0 0 448 512">
		<path fill="currentColor" d="M416 208H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h384c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"></path>
	</symbol>

	<symbol id="icon-plus" aria-hidden="true" focusable="false" role="img" viewBox="0 0 448 512">
		<path fill="currentColor" d="M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"></path>
	</symbol>

	<symbol id="icon-play" aria-hidden="true" focusable="false" role="img" viewBox="0 0 448 512">
		<path fill="currentColor" d="M424.4 214.7L72.4 6.6C43.8-10.3 0 6.1 0 47.9V464c0 37.5 40.7 60.1 72.4 41.3l352-208c31.4-18.5 31.5-64.1 0-82.6z"></path>
	</symbol>

	<symbol id="icon-pause" aria-hidden="true" focusable="false" role="img" viewBox="0 0 448 512">
		<path fill="currentColor" d="M144 479H48c-26.5 0-48-21.5-48-48V79c0-26.5 21.5-48 48-48h96c26.5 0 48 21.5 48 48v352c0 26.5-21.5 48-48 48zm304-48V79c0-26.5-21.5-48-48-48h-96c-26.5 0-48 21.5-48 48v352c0 26.5 21.5 48 48 48h96c26.5 0 48-21.5 48-48z"></path>
	</symbol>

	<symbol id="icon-play-circle" aria-hidden="true" focusable="false" role="img" viewBox="0 0 512 512">
		<path fill="currentColor" d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5 0-200-89.5-200-200S145.5 56 256 56s200 89.5 200 200-89.5 200-200 200zm96-280v160c0 8.8-7.2 16-16 16h-48c-8.8 0-16-7.2-16-16V176c0-8.8 7.2-16 16-16h48c8.8 0 16 7.2 16 16zm-112 0v160c0 8.8-7.2 16-16 16h-48c-8.8 0-16-7.2-16-16V176c0-8.8 7.2-16 16-16h48c8.8 0 16 7.2 16 16z"></path>
	</symbol>

	<symbol id="icon-pause-circle" aria-hidden="true" focusable="false" role="img" viewBox="0 0 512 512">
		<path fill="currentColor" d="M371.7 238l-176-107c-15.8-8.8-35.7 2.5-35.7 21v208c0 18.4 19.8 29.8 35.7 21l176-101c16.4-9.1 16.4-32.8 0-42zM504 256C504 119 393 8 256 8S8 119 8 256s111 248 248 248 248-111 248-248zm-448 0c0-110.5 89.5-200 200-200s200 89.5 200 200-89.5 200-200 200S56 366.5 56 256z"></path>
	</symbol>

</svg>
	<dialog id="modal__privacy">
    <header>Privacy Notice</header>
    <section>
        <p>
            This app uses your camera to visualize the video stream on a particle system. Each particle is animated according to the color of that particular pixel on your webcam and the song being played. This means this app needs both your permission to capture your camera and play music.
        </p>
        <p>
            Some browsers require user interaction before any audio can be played. By clicking "okay" this app has the necessary user interaction to play music.
        </p>
        <p>
            <strong class="important">Important:</strong> I do not store anything from your camera on the server!
        </p>
        <p>
            As with most of my web experiments, use Google Chrome for an optimal user experience.
        </p>
    </section>
    <footer>
        <button class="btn" name="close">Okay</button>
    </footer>
</dialog>

	<!-- SHADERS /////////////////////////////////////////////////// -->

	<script type="x-shader/x-fragment" data-shader="fragment">
		//#define GLSLIFY 1

uniform float time;
uniform float density;
uniform bool isWebcam;
uniform bool isPlaying;

varying vec4 vMvPosition;
varying vec3 vColor;
varying vec3 vPosition;

void main() {

    vec2 uv = gl_PointCoord.xy * 2.0 - 1.0;
    vec3 color = vec3(0.005);

    if (vPosition.z > 0.1 || isWebcam == true) {

        float orb = density / length(uv * 2.0);

        orb = smoothstep(0.0, 1.0, orb);
        color = vec3(orb) * vColor;

    }

    gl_FragColor = vec4(color, 1.0);
    
}











// -------------------------------------------------------------------
// :: WORK IN PROGRESS
// -------------------------------------------------------------------

// uniform float time;
// uniform sampler2D texFire;
// uniform bool playing;

// varying vec2 vUv;
// varying vec4 vMvPosition;
// varying vec3 vColor;
// varying vec3 vPosition;

// void main() {

//     vec2 uv;
//     vec2 noise = vec2(0.0);

//     // Generate noisy y value
//     uv = vec2(vUv.x * 0.7 - 0.01, fract(vUv.y - time * 0.35));
//     noise.y = (texture2D(texFire, uv).a - 0.5) * 2.0;
//     uv = vec2(vUv.x * 0.45 + 0.033, fract(vUv.y * 1.9 - time * 0.45));
//     noise.y += (texture2D(texFire, uv).a - 0.5) * 2.0;
//     uv = vec2(vUv.x * 0.8 - 0.02, fract(vUv.y * 2.5 - time * 0.5));
//     noise.y += (texture2D(texFire, uv).a - 0.5) * 2.0;

//     noise = clamp(noise, -1.0, 1.0);

//     float perturb = (1.0 - vUv.y) * 0.35 + 0.02;
//     noise = (noise * perturb) + vUv - 0.02;

//     vec4 color = texture2D(texFire, noise / 5.0);
//     // color = vec4(color.bgr, 1.0);
//     color = vec4((color.g / color.r) * 0.1, color.g * 0.75, color.r, 1.0);
//     noise = clamp(noise, 0.05, 1.0);
//     color.a = texture2D(texFire, noise).b * 0.0;
//     color.a = color.a * texture2D(texFire, vUv).b;

//     gl_FragColor = color;

// }
	</script>
	<script type="x-shader/x-vertex" data-shader="vertex">
		//#define GLSLIFY 1

attribute vec3 color;

uniform float time;
uniform float size;

varying vec4 vMvPosition;
varying vec3 vPosition;
varying vec3 vColor;

// float map(float value, float beforeMin, float beforeMax, float afterMin, float afterMax) {

//     return afterMin + (afterMax - afterMin) * ((value - beforeMin) / (beforeMax - beforeMin));

// }

// void main() {

//     vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);

//     vMvPosition = mvPosition;
//     vColor = color;

//     // gl_PointSize = size + ((sin(time * 0.05) + 1.0) / 2.0) * 10.0;
//     gl_PointSize = size;
//     gl_Position = projectionMatrix * mvPosition;
    
// }

void main() {

    vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);

    vMvPosition = mvPosition;
    vPosition = position;
    vColor = color;

    // gl_PointSize = size + ((sin(time * 0.05) + 1.0) / 2.0) * 10.0;
    gl_PointSize = size;
    gl_Position = projectionMatrix * mvPosition;
    
}

	</script>

	<!-- SCRIPTS /////////////////////////////////////////////////////
	For 3rd party libraries we're better off using a CDN,
	providing we have a local fallback in place
	-->

	<!-- 
	<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/110/three.min.js"></script>
	<script>window.THREE || document.write('<script src="js/vendor/three-113.min.js"><\/script>')</script> 
	
	<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.3/TweenMax.min.js"></script>
	<script>window.TweenMax || document.write('<script src="js/vendor/tweenmax-2.1.3.min.js"><\/script>')</script>

	<script src="js/vendor/three-orbitcontrols.js"></script>
	-->

	<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/110/three.min.js"></script>
	<script>window.THREE || document.write('<script src="js/vendor/three-110.min.js"><\/script>')</script> 
	<script src="js/index.bundle.js" async defer="defer"></script>


	<!-- GOOGLE ANALYTICS ////////////////////////////////////////////
	- https://developers.google.com/analytics/devguides/collection/analyticsjs/#the_javascript_tracking_snippet
	- https://github.com/h5bp/html5-boilerplate/blob/master/src/index.html

	Async Google Analytics - change UA-XXXXX-X to your site ID
	<script>
		window.ga=function(){ga.q.push(arguments)};ga.q=[];ga.l=+new Date;
		ga('create','UA-XXXXX-Y','auto');ga('send','pageview')
	</script>
	<script src="https://www.google-analytics.com/analytics.js" async defer></script>
	-->

</body>
</html>
